# 设计模式与游戏完美开发
## 第3篇 角色设计
### 第10章 角色属性的计算——策略模式（Strategy）
#### 1. 角色的不同策略
- 角色除拥有“生命值”和“移动速度”这些共同属性外，
- 敌方角色攻击可以产生暴击，我方没有
- 我方角色拥有随等级成长的防御力，地方没有
- 敌方及我方角色的生命值随等级成长的策略有所不同

#### 2. 策略模式（Strategy）
- 对于条件的不同而选择不同实现方式时，最简单的做法就是用if-else或者switch来实现
- 策略模式的定义  
    - GoF定义：定义一组算法，并封装每个算法，让它们可以彼此交换使用。策略模式让这些算法在客户端使用它们时能更加独立
    - 策略模式基本架构图如下：

#### 3. 使用策略模式
- 类图关系

- 实现说明

- 策略模式优点
     - 让角色属性变得更好维护  
    使用ICharacterAttr来封装角色属性
    - 避免使用if-else或switch来判断角色类型
    - 伤害计算公式替换更加方便

- 注意事项
    - 计算公式时的参数设置
    如何设计使得不通过向下转型获取需要的参数？
    - 与状态模式的区别  
    State群组之间有对应和连接关系，Strategy群组之间则没有；State群组之间存在一定依赖关系，要在设计初期就尽可能考虑所有状态，而Strategy群组之间没有依赖，方便后期新增。

#### 4. 策略模式面对变化时
直接增加或删除对应策略即可，非常方便

#### 5. 结论
- 搭配Builder模式使用
- 其他应用方式：角色攻击力计算，角色操控载具策略，注册账号策略，支付策略等等。
  
  
  
  
  
### 第11章 模板方法模式（Template Method）
#### 1. 问题抛出  
如武器计算问题上，除了特效和音效的差别，其他逻辑都非常类似，存在大量重复。

#### 2.模板方法模式（Template Method）
- **GoF定义**：在一个操作方法中定义算法的流程，其中某些步骤由子类完成。模板方法模式让子类在不变更原有算法流程的情况下，还能够重新定义其中的步骤。



### 第12章 角色AI——状态模式（State）



